{"version":3,"sources":["../../../../src/db/graphql/resolvers/createTeam.js"],"names":["executeCreateTeam","nonce","name","session","Session","findOne","where","err","response","user","getUser","team","Team","create","addUser","through","type","active","activationNonce","generate","console","error","message","createTeam","_","args","context","log"],"mappings":";;;;;;;;;;AAAA;;;;AACA;;;;;;AAEA,MAAMA;AAAA,6CAAoB,WAAO,EAAEC,KAAF,EAASC,IAAT,EAAP,EAA2B;AACnD,QAAI;AACF,UAAIC,UAAW,MAAM,wBAAGC,OAAH,CAAWC,OAAX,CAAmB,EAAEC,OAAO,EAAEL,KAAF,EAAT,EAAnB,CAArB;AACA,UAAG,CAACE,OAAJ,EAAa;AAAE,eAAO,EAAEI,KAAK,IAAP,EAAaC,UAAU,+BAAvB,EAAP;AAAiE;AAChF,UAAIC,OAAO,MAAMN,QAAQO,OAAR,EAAjB;AACA,UAAG,CAACD,IAAJ,EAAU;AAAE,eAAO,EAAEF,KAAK,IAAP,EAAaC,UAAU,+BAAvB,EAAP;AAAiE;AAC7E,UAAIG,OAAO,MAAM,wBAAGC,IAAH,CAAQC,MAAR,CAAe,EAAEX,IAAF,EAAf,CAAjB;AACA,YAAMS,KAAKG,OAAL,CAAaL,IAAb,EAAmB,EAAEM,SAAS,EAAEC,MAAM,OAAR,EAAiBC,QAAQ,IAAzB,EAA+BC,iBAAiB,kBAAQC,QAAR,EAAhD,EAAX,EAAnB,CAAN;AACA,aAAO,EAAEZ,KAAK,KAAP,EAAcC,UAAW,WAAUN,IAAK,eAAxC,EAAP;AACD,KARD,CAQE,OAAMK,GAAN,EAAW;AACXa,cAAQC,KAAR,CAAcd,GAAd;AACA,aAAO,EAAEA,KAAK,IAAP,EAAaC,UAAUD,IAAIe,OAA3B,EAAP;AACD;AACF,GAbK;;AAAA;AAAA;AAAA;AAAA,IAAN;;AAeA,MAAMC,aAAa,CAACC,CAAD,EAAIC,IAAJ,EAAUC,OAAV,KAAsB;AACvCN,UAAQO,GAAR,CAAY,YAAZ;AACA,SAAO3B,kBAAkByB,IAAlB,CAAP;AACD,CAHD;;kBAKeF,U","file":"createTeam.js","sourcesContent":["import db from '../../sequelize/models/db_connection'\nimport shortId from 'shortid'\n\nconst executeCreateTeam = async ({ nonce, name }) => {\n  try {\n    let session =  await db.Session.findOne({ where: { nonce } })\n    if(!session) { return { err: true, response: 'Whoops! Something went wrong.' } }\n    let user = await session.getUser()\n    if(!user) { return { err: true, response: 'Whoops! Something went wrong.' } }\n    let team = await db.Team.create({ name })\n    await team.addUser(user, { through: { type: 'OWNER', active: true, activationNonce: shortId.generate() } })\n    return { err: false, response: `Success ${name} was created!` }\n  } catch(err) {\n    console.error(err)\n    return { err: true, response: err.message }\n  }\n}\n\nconst createTeam = (_, args, context) => {\n  console.log('createTeam')\n  return executeCreateTeam(args)\n}\n\nexport default createTeam\n"]}