{"version":3,"sources":["../../../../src/db/graphql/resolvers/authHandler.js"],"names":["context","callback","callback_args","session","Session","findOne","where","nonce","token","console","log","user","User","id","userId","authHandler"],"mappings":";;;;;;;;;;;;;;;6CAGA,WAA2BA,OAA3B,EAAoCC,QAApC,EAA8CC,aAA9C,EAA6D;AAC3D,UAAMC,UAAU,MAAM,wBAAGC,OAAH,CAAWC,OAAX,CAAmB,EAAEC,OAAO,EAAEC,OAAOP,QAAQQ,KAAjB,EAAT,EAAnB,CAAtB;AACA,QAAIL,WAAW,IAAf,EAAsB;AACpBM,cAAQC,GAAR,CAAY,uCAAZ;AACA;AACD;AACD,UAAMC,OAAO,MAAM,wBAAGC,IAAH,CAAQP,OAAR,CAAgB,EAAEC,OAAO,EAAEO,IAAIV,WAAWA,QAAQW,MAAzB,EAAT,EAAhB,CAAnB;AACA,QAAK,OAAOH,IAAP,KAAgB,WAAhB,IAA+BA,QAAQ,IAA5C,EAAkD;AAChDF,cAAQC,GAAR,CAAY,oCAAZ;AACA;AACD;AACD,WAAOT,oCAAaC,aAAb,IAA4BY,QAAQH,KAAKE,EAAzC,IAAP;AACD,G;;kBAZcE,W;;;;;AAHf;;;;;;kBAkBeA,W","file":"authHandler.js","sourcesContent":["import db from '../../sequelize/models/db_connection'\n\n\nasync function authHandler(context, callback, callback_args) {\n  const session = await db.Session.findOne({ where: { nonce: context.token } })\n  if( session == null ) {\n    console.log('no session found - skipping execution')\n    return\n  }\n  const user = await db.User.findOne({ where: { id: session && session.userId } })\n  if ( typeof user === \"undefined\" || user == null) {\n    console.log('no user found - skipping execution')\n    return\n  }\n  return callback({...callback_args, userId: user.id })\n}\n\n\nexport default authHandler\n"]}